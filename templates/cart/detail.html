{% extends 'base.html' %}
{% block title %}Your Cart - Store{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto animate-fade-up">
    <h1 class="text-2xl font-bold tracking-tight mb-8" style="color: var(--text-primary);">Shopping Cart</h1>

    {% if cart.items.all %}
    <div class="rounded-2xl overflow-hidden" style="border: 1px solid var(--border);">
        <div class="divide-y" style="border-color: var(--border-light);">
            {% for item in cart.items.all %}
            <div class="p-6 flex flex-col sm:flex-row items-center gap-5 transition-colors">
                <div class="w-20 h-20 flex-shrink-0 rounded-xl overflow-hidden" style="background: var(--bg-soft);">
                    {% if item.product.image %}
                    <img src="{{ item.product.image.url }}" alt="{{ item.product.name }}" class="w-full h-full object-cover">
                    {% else %}
                    <div class="w-full h-full flex items-center justify-center" style="color: var(--text-muted);">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                        </svg>
                    </div>
                    {% endif %}
                </div>

                <div class="flex-grow text-center sm:text-left">
                    <h3 class="text-sm font-bold" style="color: var(--text-primary);">{{ item.product.name }}</h3>
                    <p class="text-xs mt-0.5" style="color: var(--text-muted);">{{ item.product.category.name }}</p>
                </div>

                <div class="flex items-center gap-5">
                    <form action="{% url 'cart:cart_update' item.id %}" method="post" class="flex items-center gap-2">
                        {% csrf_token %}
                        <input type="number" name="quantity" value="{{ item.quantity }}" min="1" max="{{ item.product.stock }}"
                            class="w-14 text-center text-sm font-medium rounded-lg py-1.5 outline-none"
                            style="background: var(--bg-soft); border: 1px solid var(--border); color: var(--text-primary);">
                        <button type="submit" class="text-xs font-medium" style="color: var(--accent);">Update</button>
                    </form>

                    <p class="text-sm font-bold w-20 text-right" style="color: var(--text-primary);">${{ item.total_price }}</p>

                    <form action="{% url 'cart:cart_remove' item.id %}" method="post">
                        {% csrf_token %}
                        <button type="submit" class="p-1.5 rounded-full text-red-400 hover:text-red-500 hover:bg-red-50 transition-colors">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                        </button>
                    </form>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- Cart Footer -->
        <div class="p-8" style="background: var(--bg-soft); border-top: 1px solid var(--border);">
            <div class="flex justify-between items-center mb-6">
                <span class="text-sm font-medium" style="color: var(--text-secondary);">Order Total</span>
                <span class="text-2xl font-bold" style="color: var(--text-primary);">${{ total_price }}</span>
            </div>
            <div class="flex flex-col sm:flex-row gap-3">
                <a href="{% url 'product_list' %}" class="btn-outline flex-1 justify-center">Continue Shopping</a>
                <a href="{% url 'orders:checkout' %}" class="btn-primary flex-[1.5] justify-center !py-3.5">Proceed to Checkout</a>
            </div>
        </div>
    </div>
    {% else %}
    <div class="text-center py-20 rounded-2xl" style="border: 1px solid var(--border);">
        <div class="w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center" style="background: var(--accent-light);">
            <svg class="w-8 h-8" style="color: var(--accent);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path>
            </svg>
        </div>
        <h2 class="text-lg font-bold mb-1" style="color: var(--text-primary);">Your cart is empty</h2>
        <p class="text-sm mb-6" style="color: var(--text-muted);">Looks like you haven't added anything yet.</p>
        <a href="{% url 'product_list' %}" class="btn-primary">Start Shopping</a>
    </div>
    {% endif %}
</div>
{% endblock %}